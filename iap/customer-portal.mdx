---
title: 'Customer Portal'
description: 'How customers can manage their own subscriptions'
icon: 'user-gear'
---

ZeroSettle provides a customer portal powered by Stripe where your customers can manage their subscriptions and payment methods — both in-app and via email links.

## In-App Portal

### SwiftUI Modifier

The simplest way to add subscription management is the `.zsManageSubscription()` modifier:

```swift
@State private var showManageSubscription = false

Button("Manage Subscription") {
    showManageSubscription = true
}
.zsManageSubscription(isPresented: $showManageSubscription, userId: currentUser.id)
```

This automatically routes to the right management UI based on where the user's subscriptions came from.

### Programmatic API

For more control, use the methods directly:

<CodeGroup>

```swift Swift
// Smart routing — picks the right UI based on entitlement sources
try await ZeroSettle.shared.showManageSubscription(userId: currentUser.id)

// Always open the Stripe customer portal
try await ZeroSettle.shared.openCustomerPortal(userId: currentUser.id)
```

```kotlin Kotlin
// Smart routing — picks the right UI based on entitlement sources
ZeroSettle.showManageSubscription(activity = this, userId = currentUser.id)

// Always open the Stripe customer portal
ZeroSettle.openCustomerPortal(activity = this, userId = currentUser.id)
```

</CodeGroup>

## Dual-Source Handling

`showManageSubscription()` inspects the user's current entitlements and routes accordingly:

| Entitlement Sources | Management UI |
|---|---|
| Web checkout only | Stripe customer portal |
| StoreKit only (iOS) | Apple's native subscription management |
| Play Store only (Android) | Google Play subscription management |
| Both web + native store | Stripe customer portal |
| No entitlements | Stripe customer portal |

If you always want the Stripe portal regardless of source, call `openCustomerPortal(userId:)` directly.

## Auto-Refresh

Entitlements are automatically refreshed when the management UI is dismissed. Any subscription changes the user makes (cancellation, plan change, re-subscribe) will be reflected in `ZeroSettle.shared.entitlements` and trigger the `zeroSettleEntitlementsDidUpdate(_:)` delegate callback.

```swift
// Entitlements stay in sync automatically after portal dismiss
let entitlements = ZeroSettle.shared.entitlements
let hasAccess = entitlements.contains { $0.isActive }
```

## Delegate Callbacks

Subscribe to customer portal lifecycle events:

```swift
class MyDelegate: ZeroSettleDelegate {
    func zeroSettleCustomerPortalDidOpen(userId: String) {
        // Portal opened — e.g., log analytics
    }

    func zeroSettleCustomerPortalDidClose(userId: String) {
        // Portal dismissed — entitlements already refreshed
    }

    func zeroSettleCustomerPortalDidFail(userId: String, error: Error) {
        // Failed to open — e.g., show error alert
    }
}
```

## What Customers Can Do

In the Stripe customer portal, customers can:

- **See upcoming payment information** — View details about their next billing cycle
- **Cancel a subscription** — End their subscription with immediate effect or at period end
- **Change subscription products** — Upgrade or downgrade to different subscription tiers
- **Re-subscribe** — Reactivate a cancelled subscription before it expires
- **Update payment methods** — Change or add new payment methods
- **View payment history** — See a complete list of all past payments
- **Download receipts and invoices** — Get PDF receipts and invoices for their records

## Email Links

Customers can also access their portal through links included in emails that ZeroSettle sends automatically:

- **Subscription confirmation** emails
- **Renewal receipt** emails
- **Billing issue** notifications

Each email contains a "Manage Subscription" link that opens the Stripe-powered billing portal.
